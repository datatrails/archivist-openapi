
.. _asset_vulnerability:

Asset Vulnerability Report
--------------------------

.. include:: ../auth_url.rst

Define the asset_identity:

.. code-block:: shell

    $ ASSET_IDENTITY=assets/add30235-1424-4fda-840a-d5ef82c4c96f

Define the vulnerability report and store in /path/to/jsonfile:

.. code-block:: JSON

    [
        {
            "asset_identity": "$ASSET_IDENTITY",
            "type": "VulnerabilityReport",
            "extended_attributes": {
                "cve_id": "CVE-2014-0160"
            },
            "type_attributes": {},
            "principal_declared": {
                "issuer": "job.idp.server/1234",
                "subject": "bob@job"
             },
             "description": "Heartbleed",
             "attachments": []
         }
     ]

.. note::
    attachments
        optional.

    See :ref:`attachments_upload`.

    asset_identity
        **required** in each instance.

    More than one event can be registered in the same POST request.

    For example one can specify additional firmware and other events

    See :ref:`asset_firmware`.

    See `Swagger POST API <openapi.html#post--archivist-v1-asset_identity-events>`_


Register the events on different assets:

.. code-block:: shell

    $ curl -v -X POST \
        -H "@$BEARER_TOKEN_FILE" \
        -H "Content-type: application/json" \
        -d "@/path/to/jsonfile" \
        $URL/archivist/v1/assets/$ASSET_IDENTIY/events


The response is:

.. code-block:: JSON

    [
        {
            "identity": "assets/add30235-1424-4fda-840a-d5ef82c4c96f/events/11bf5b37-e0b8-42e0-8dcf-dc8c4aefc000",
            "asset_identity": "assets/add30235-1424-4fda-840a-d5ef82c4c96f",
            "principal_declared": {
                "issuer": "",
                "subject": "Bob from Suffolk"
            },
            "principal_accepted": {
                "issuer": "job.idp.server/1234",
                "subject": "bob@job"
            },
            "description": "Heartbleed",
            "timestamp_declared": "2019-03-29T11:00:00+00:00",
            "confirmation_status": "CONFIRMED",
            "timestamp_committed": "2019-03-29T12:01:00+00:00",
            "timestamp_accepted": "2019-03-29T12:00:00+00:00",
            "extended_attributes": {
                "cve_id": "CVE-2014-0160"
            },
            "type": "VulnerabilityReport",
            "transaction_id": "0x04756",
            "block_number": 12,
            "transaction_index": 5,
            "type_attributes": {},
            "attachments": []
        }
    ]


.. note::
    identity
        used internally by the Jitsuin system to track this event.

    confirmation_status
        1. "CONFIRMATION_STATUS_PENDING": asset has not yet been registered on the Ledger.
        2. "CONFIRMATION_STATUS_CONFIRMED": asset has been registered on the Ledger.

